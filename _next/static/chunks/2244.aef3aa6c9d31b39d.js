!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0a416512-1915-44f3-aced-27287cdb4430",e._sentryDebugIdIdentifier="sentry-dbid-0a416512-1915-44f3-aced-27287cdb4430")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2244],{56112:(e,t,r)=>{r.d(t,{a:()=>i});var n=r(31198),a=r(25282),l=r(14232);class o extends n.ScaleControl{onAdd(e){let t=super.onAdd(e);return t.addEventListener("click",this.onClick),t.setAttribute("style","cursor: pointer"),t.addEventListener("mouseover",()=>this.setText(this.getHoverText())),t.addEventListener("mouseout",()=>this._onMove()),t}setText(e){this._container.innerHTML=e}constructor({onClick:e,getHoverText:t,...r}){super(r),this.onClick=e,this.getHoverText=t}}let i=(e,t)=>{let{userSettings:r,setUserSetting:n}=(0,a.dk)(),{isImperial:i}=r;(0,l.useEffect)(()=>{let r=e.current;if(!t||!r)return;let a=new o({maxWidth:80,unit:i?"imperial":"metric",onClick:()=>n("isImperial",!i),getHoverText:()=>i?"km":"mile"});try{r.addControl(a,"bottom-right")}catch(e){}return()=>{try{r.removeControl(a)}catch(e){}}},[e,t,i,n])}},62244:(e,t,r)=>{r.r(t),r.d(t,{default:()=>er});var n=r(18153),a=r(14232),l=r(74350),o=r(95063),i=r(5820),s=r(98975),c=r(31198),u=r.n(c),d=r(11276),p=r(9927),f=r(57395),y=r(78944),h=r(40359),m=r(82777),v=r(14259),g=r(86422),x=r(42799);let L=e=>{if(!e)return!1;let[t,r]=e;return r>=-90&&r<=90&&t>=-180&&t<=180},w={color:"#555",opacity:"0.4"},b=(0,g.Bd)((e,t)=>{let{items:r,markerRefs:a,setCurrent:l,current:o}=t;a.current.forEach(e=>e.remove()),a.current=[],r.forEach(t=>{if(!L(t.nodeLonLat)||t.shortId===o||"n"!==t.shortId[0])return;let[r,i]=t.nodeLonLat,s=new(u()).Marker(w).setLngLat({lng:r,lat:i}).addTo(e),c=document.createElement("div");y.createRoot(c).render((0,n.Y)(()=>{var e;return(0,n.FD)(h.A,{direction:"column",gap:2,"data-sentry-element":"Stack","data-sentry-component":"MyPopupContent","data-sentry-source-file":"useStaticMarkers.tsx",children:[(0,n.Y)(m.A,{variant:"subtitle2",color:"primary","data-sentry-element":"Typography","data-sentry-source-file":"useStaticMarkers.tsx",children:(null==(e=t.tags)?void 0:e.name)||t.shortId}),(0,n.Y)(v.A,{size:"small",variant:"contained",onClick:()=>l(t.shortId),"data-sentry-element":"Button","data-sentry-source-file":"useStaticMarkers.tsx",children:(0,x.t)("editdialog.location_change_current_item")})]})},{}));let d=new(u()).Popup({offset:25}).setDOMContent(c);s.setPopup(d),a.current.push(s)})});var C=r(56152),k=r(19788),E=r(71734),I=r(3094);let A=(e,t)=>e.filter(e=>"r"===e.shortId[0]).find(e=>{var r;return null==(r=e.members)?void 0:r.some(e=>e.shortId===t)}),M=e=>{let{shortId:t}=e;return["n","w"].includes(t[0])},Y=()=>(0,I.UK)().getCenter().toArray(),_=e=>!e.includes("-"),T=async e=>{let t=await (0,k.G)((0,E.k1)(e));if("n"===e[0])return[t.lon,t.lat];if("w"===e[0]){var r;if((null==(r=t.nodes)?void 0:r.length)>0){let e=await (0,k.G)({type:"node",id:t.nodes[0]});return[e.lon,e.lat]}}},F=async(e,t)=>{let r=t.members.filter(M).toReversed();if(r.length)for(let t of r){let r=(0,C.pT)(e,t.shortId);if(null==r?void 0:r.nodeLonLat)return r.nodeLonLat;if(_(t.shortId))return await T(t.shortId)}},S=async(e,t)=>{let r=A(e,t);if(!r)return;let n=await F(e,r),a=null==n?void 0:n.map(e=>e+5e-5);return null!=a?a:r.relationClickedLonLat},z=async(e,t)=>{var r;return null!=(r=await S(e,t))?r:Y()},R=document.createElement("div");R.style.width="27px",R.style.height="41px",R.style.zIndex="999",R.innerHTML='\n<svg xmlns="http://www.w3.org/2000/svg" width="27" height="41" display="block">\n    <g transform="translate(3 29)">\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="10.5" ry="5.25"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="10.5" ry="5.25"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="9.5" ry="4.773"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="8.5" ry="4.295"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="7.5" ry="3.818"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="6.5" ry="3.341"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="5.5" ry="2.864"/>\n        <ellipse cx="10.5" cy="5.8" opacity=".04" rx="4.5" ry="2.386"/>\n    </g>\n    <path fill="salmon"\n          d="M27 13.5c0 5.575-6.75 13.5-12.25 21-.733 1-1.767 1-2.5 0C6.75 27 0 19.223 0 13.5 0 6.044 6.044 0 13.5 0S27 6.044 27 13.5Z"/>\n    <path d="M13.5 0C6.044 0 0 6.044 0 13.5c0 5.723 6.75 13.5 12.25 21 .75 1.023 1.767 1 2.5 0C20.25 27 27 19.075 27 13.5 27 6.044 20.956 0 13.5 0Zm0 1C20.415 1 26 6.585 26 13.5c0 2.399-1.504 5.681-3.78 9.238-2.274 3.557-5.515 7.404-8.277 11.17-.2.273-.33.415-.443.533a4.934 4.934 0 0 1-.443-.533c-2.773-3.78-5.642-7.594-8.041-11.135C2.616 19.233 1 15.953 1 13.5 1 6.585 6.585 1 13.5 1Z"\n          opacity=".25"/>\n    <path d="m13.825 4.872 3.44 3.561-1.147 1.187-1.482-1.534v4.573h4.573l-1.535-1.482 1.187-1.147 3.561 3.44-3.56 3.438-1.188-1.146 1.535-1.482h-4.573v4.573l1.482-1.535 1.146 1.187-3.439 3.561-3.439-3.56 1.147-1.188 1.482 1.535V14.28H8.44l1.535 1.482-1.187 1.146-3.561-3.439 3.561-3.439 1.187 1.147-1.535 1.482h4.574V8.086L11.533 9.62l-1.147-1.187Z"\n          fill="#fff"/>\n</svg>';let D={draggable:!0,element:R,offset:[0,-14]};var $=r(56112);let H=e=>{let{nodeLonLat:t}=(0,f.af)(),r=(0,a.useRef)(null),n=(0,a.useCallback)(()=>{if(t&&L(t)&&(!r.current||r.current[0]!==t[0]||r.current[1]!==t[1])){var n;null==(n=e.current)||n.easeTo({center:t}),r.current=t}},[e,t]);(0,a.useEffect)(()=>{if(!e.current)return;let t=e.current;return t.on("load",n),()=>{t.off("load",n)}},[e,n]),(0,a.useEffect)(n,[n])},Z=new(u()).GeolocateControl({positionOptions:{enableHighAccuracy:!0},fitBoundsOptions:{duration:4e3},trackUserLocation:!0}),q=()=>(0,I.UK)().getCenter().toArray();var N=r(49416),B=r(37876);let G=(0,N.A)((0,B.jsx)("path",{d:"m11.99 18.54-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27z"}),"Layers"),j=e=>"satellite"===e?"https://api.maptiler.com/maps/hybrid/style.json?key=".concat("7dlhLl3hiXQ1gsth0kGu"):d.Y;var K=r(91349);let O=e=>e.replace(/(\.\d*?)0*$/,"$1").replace(/\.$/,"").replace(/^0*(\d)/,"$1")==="".concat(parseFloat(e)),P=e=>(0,n.Y)(K.A,{label:(0,x.t)("editdialog.location_longitude"),variant:"outlined",value:e.value,onChange:e.onChange,size:"small",error:e.value&&e.lonError,"data-sentry-element":"TextField","data-sentry-component":"LonInput","data-sentry-source-file":"LocationInputs.tsx"}),U=e=>(0,n.Y)(K.A,{label:(0,x.t)("editdialog.location_latitude"),variant:"outlined",value:e.value,onChange:e.onChange,size:"small",error:e.value&&e.latError,"data-sentry-element":"TextField","data-sentry-component":"LatInput","data-sentry-source-file":"LocationInputs.tsx"}),V=()=>{let{nodeLonLat:e,setNodeLonLat:t}=(0,f.af)(),[r,l]=(0,a.useState)(!1),[o,i]=(0,a.useState)("".concat((null==e?void 0:e[0])||"")),[s,c]=(0,a.useState)(!1),[u,d]=(0,a.useState)("".concat((null==e?void 0:e[1])||"")),p=(0,a.useRef)();(0,a.useEffect)(()=>{e&&p.current!==e&&(i("".concat(e[1]||"")),d("".concat(e[0]||"")))},[e]);let y=(e,r)=>{let n=[e,r];if(n.every(O)){let e=n.map(parseFloat);t(e),p.current=e,c(!1),l(!1)}else O(e)||c(!0),O(r)||l(!0)};return(0,n.FD)(h.A,{direction:"row",mt:2,gap:1,"data-sentry-element":"Stack","data-sentry-component":"LocationInputs","data-sentry-source-file":"LocationInputs.tsx",children:[(0,n.Y)(U,{value:o,onChange:e=>{i(e.target.value),y(u,e.target.value)},latError:r,"data-sentry-element":"LatInput","data-sentry-source-file":"LocationInputs.tsx"}),(0,n.Y)(P,{value:u,onChange:e=>{d(e.target.value),y(e.target.value,o)},lonError:s,"data-sentry-element":"LonInput","data-sentry-source-file":"LocationInputs.tsx"})]})},W=(0,s.A)("div",{target:"ekqwxzt0"})("height:500px;position:relative;overflow:hidden;left:-30px;width:calc(100% + 60px);border-radius:3px;"),X=(0,s.A)("div",{target:"ekqwxzt1"})("height:100%;width:100%;position:absolute;display:flex;align-items:center;justify-content:center;"),Q=(0,s.A)("div",{target:"ekqwxzt2"})("visibility:",e=>{let{$isVisible:t}=e;return t?"visible":"hidden"},";height:100%;width:100%;"),J=(0,s.A)("div",{target:"ekqwxzt3"})("position:absolute;top:4px;right:4px;"),ee=(0,s.A)(l.A,{target:"ekqwxzt4"})("position:absolute;bottom:8px;left:50%;transform:translateX(-50%);"),et=()=>(0,n.Y)(ee,{severity:"info","data-sentry-element":"StyledAlert","data-sentry-component":"NoLocationAlert","data-sentry-source-file":"EditFeatureMap.tsx",children:(0,x.t)("editdialog.no_location_alert")}),er=e=>{let{mapStyle:t,setMapStyle:r}=e,{containerRef:l,isMapLoaded:s,mapRef:c}=function(){let e=(0,a.useRef)(null),t=(0,a.useRef)(null),[r,n]=(0,a.useState)(!1),{current:l}=(0,f.$E)(),o=(0,f.af)(),{current:i,items:s,setCurrent:c}=(0,f.$E)(),y=(0,a.useRef)([]);b(t.current,{markerRefs:y,items:s,setCurrent:c,current:i});let{onMarkerChange:h}=function(e){let t=e.current,{items:r}=(0,f.$E)(),{nodeLonLat:n,setNodeLonLat:l,shortId:o}=(0,f.af)(),i=(0,a.useRef)();return(0,a.useEffect)(()=>{(async()=>{var e;if(!t)return;null==(e=i.current)||e.remove(),i.current=void 0;let a=null!=n?n:await z(r,o);a&&(i.current=new(u()).Marker(D).setLngLat(a).addTo(t),t.easeTo({center:a}),i.current.on("dragend",()=>{var e;l(null==(e=i.current)?void 0:e.getLngLat().toArray())}))})()},[r,t,n,l,o]),{onMarkerChange:e=>{let{lng:t,lat:r}=e;l([t,r])}}}(t);return(0,a.useEffect)(()=>{if(!e.current)return;n(!1);let r=new(u()).Map({container:e.current,style:d.Y,attributionControl:!1,refreshExpiredTiles:!1,zoom:18,center:q(),locale:{"NavigationControl.ResetBearing":p.f}});r.scrollZoom.setWheelZoomRate(.005),r.addControl(Z),t.current=r;let a=()=>n(!0);return r.on("load",a),()=>{r.off("load",a),r.remove(),t.current=null}},[e,l]),H(t),(0,$.a)(t,r),{containerRef:e,isMapLoaded:r,currentItem:o,onMarkerChange:h,mapRef:t}}();(0,a.useEffect)(()=>{let e=j(t);c.current.setStyle(e)},[t,c]);let{shortId:y,nodeLonLat:h}=(0,f.af)();return"n"!==y[0]?null:(0,n.FD)(n.FK,{children:[(0,n.FD)(W,{"data-sentry-element":"Container","data-sentry-source-file":"EditFeatureMap.tsx",children:[!s&&(0,n.Y)(X,{children:(0,n.Y)(o.A,{color:"primary"})}),(0,n.Y)(Q,{className:"edit-feature-map",$isVisible:s,ref:l,"data-sentry-element":"Map","data-sentry-source-file":"EditFeatureMap.tsx"}),(0,n.Y)(J,{"data-sentry-element":"MapStyle","data-sentry-source-file":"EditFeatureMap.tsx",children:(0,n.Y)(i.A,{component:"button",label:t,icon:(0,n.Y)(G,{}),onClick:()=>{"outdoor"===t?r("satellite"):r("outdoor")},color:"secondary","data-sentry-element":"Chip","data-sentry-source-file":"EditFeatureMap.tsx"})}),void 0===h&&(0,n.Y)(et,{})]}),(0,n.Y)(V,{"data-sentry-element":"LocationInputs","data-sentry-source-file":"EditFeatureMap.tsx"},y)]})}}}]);